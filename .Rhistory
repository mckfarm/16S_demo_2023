library(qiime2R)
if (!requireNamespace("devtools", quietly = TRUE)){install.packages("devtools")}
devtools::install_github("jbisanz/qiime2R")
library(qiime2R)
library(phyloseq)
library(tidyverse)
library(qiime2R)
library(phyloseq)
library(tidyverse)
taxonomy <- read_qza(file.path("data/taxonomy.qza"))
library(qiime2R)
library(phyloseq)
library(tidyverse)
taxonomy <- read_qza(file.path("data/taxonomy.qza"))
View(taxonomy)
table <- read_qza(file.path("data/table_dada2.qza"))
View(table)
table.data
taxonomy <- read_qza(file.path("data/taxonomy.qza"))
counts <- read_qza(file.path("data/table_dada2.qza"))
View(counts)
counts[["data"]]
View(taxonomy)
taxonomy[["data"]]
taxonomy <- read_qza(file.path("data/taxonomy.qza"))
counts <- read_qza(file.path("data/table_dada2.qza"))
taxonomy<-parse_taxonomy(taxonomy$data)
View(taxonomy)
taxonomy <- read_qza(file.path("data/taxonomy.qza"))
counts <- read_qza(file.path("data/table_dada2.qza"))
df_tax <- parse_taxonomy(taxonomy$data)
df_counts <- as.data.frame(counts[["data"]])
all_data_phyloseq <- qiime2R::qza_to_phyloseq(
features="./data/table_dada2.qza",
tree="./data/rooted_tree.qza",
taxonomy="./data/taxonomy.qza",
metadata = "./data/metadata.csv"
)
all_data_phyloseq <- qiime2R::qza_to_phyloseq(
features="./data/table_dada2.qza",
tree="./data/rooted_tree.qza",
taxonomy="./data/taxonomy.qza",
metadata = "./data/16S_metadata.txt"
)
phyloseq_all <- qiime2R::qza_to_phyloseq(
features="./data/table_dada2.qza",
tree="./data/rooted_tree.qza",
taxonomy="./data/taxonomy.qza",
metadata = "./data/16S_metadata.txt"
)
phyloseq_all <- qiime2R::qza_to_phyloseq(
features="./data/table_dada2.qza",
tree="./data/rooted_tree.qza",
taxonomy="./data/taxonomy.qza",
metadata = "./data/16S_metadata.txt"
)
# remove Mitochondria (eukaryotes) and Chloroplasts
phyloseq_filt <- subset_taxa(phyloseq_all,
!Genus=="Mitochondria" & !Genus=="Chloroplast")
phyloseq_filt_rel <- transform_sample_counts(phyloseq_filt, function(x) x*100/sum(x))
# remove Mitochondria (eukaryotes) and Chloroplasts
phyloseq_filt <- subset_taxa(phyloseq_all,
!Genus=="Mitochondria" & !Genus=="Chloroplast")
# relative abundance
phyloseq_filt_rel <- transform_sample_counts(phyloseq_filt, function(x) x*100/sum(x))
# remove phyloseq_all object
rm(phyloseq_all)
# remove Mitochondria (eukaryotes) and Chloroplasts
phyloseq_filt <- phyloseq::subset_taxa(phyloseq_all,
!Genus=="Mitochondria" & !Genus=="Chloroplast")
phyloseq_all <- qiime2R::qza_to_phyloseq(
features="./data/table_dada2.qza",
tree="./data/rooted_tree.qza",
taxonomy="./data/taxonomy.qza",
metadata = "./data/16S_metadata.txt"
)
# remove Mitochondria (eukaryotes) and Chloroplasts
phyloseq_filt <- phyloseq::subset_taxa(phyloseq_all,
!Genus=="Mitochondria" & !Genus=="Chloroplast")
# relative abundance
phyloseq_filt_rel <- phyloseq::transform_sample_counts(phyloseq_filt, function(x) x*100/sum(x))
# remove phyloseq_all object
rm(phyloseq_all)
